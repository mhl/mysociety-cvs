<?
template_draw('header', $values);
$data = $values['data'];
$info = $data['info'];
$data = $data['data'];
$sort = $info['sort'];
?>
<h2><?=$values['title']?></h2>
<p id="zeitgeist_nav"><a href="/stats/<?=$values['year']?>/zeitgeist">Summary</a> | <strong>MP Responsiveness League Table</strong></p>

<p>WriteToThem sent <strong><?=number_format($info['total_dispatched_success']) ?></strong>
 messages to MPs last year and <strong><?=number_format($info['non_mp_sent']) ?></strong> to other elected representatives.
<strong><?=number_format($info['total_responded_outof']) ?></strong> people answered our feedback survey
about communicating with their MP. This asked whether MPs had responded to their message within two to three weeks.

<p><em>Journalists: please feel free to use the data on this page, but if you do you <em>must</em> cite WriteToThem.com in the body of your articles as the source of any analysis or data you get off this site.</em></p>

<p><small><strong>Note:</strong> "95% confidence interval" means given how
much or little data we have, we are only sure the value is in that range. There
are over 650 MPs in this list because it includes MPs from before and
after the 2005 election.</small></p>

<?
$head_name = 'Name (Party)'; if ($sort != 'n') $head_name = '<a href="?o=n">' . $head_name . '</a>';
$head_cons = 'Constituency'; if ($sort != 'c') $head_cons = '<a href="?o=c">' . $head_cons . '</a>';
$head_messages = 'Messages sent to MP'; if ($sort != 's') $head_messages = '<a href="?o=s">' . $head_messages . '</a>';
$head_response = 'Response rate by MP'; if ($sort != 'r') $head_response = '<a href="?">' . $head_response . '</a>';
?>
<table class="zeitgeist">
<tr>
<? if ($sort == 'r') print '<th>Pos<sup>n</sup></th>'; ?>
<th><?=$head_name ?></th>
<th><?=$head_cons ?></th>
<th><?=$head_messages ?></th>
<th><?=$head_response ?></th>
<th>95% confidence interval</th>
</tr>
<?

$c = 0;
$linebreak = false;
foreach ($data as $row) {
    print '<tr';
    $classes = array();
    if ($sort == 'r' && !$linebreak && $row['notes']) {
        $classes[] = 'break';
	$linebreak = true;
    }
    if ($c++%2) $classes[] = 'a';
    if (count($classes))
        print ' class="' . join(' ', $classes) . '"';
    print '>';
    if ($sort == 'r') {
        print '<td class="c">';
	if (!$row['notes']) {
	    print "$c<br><small>";
	    if ($row['fymp_rank']) {
	    	$diff = $c - $row['fymp_rank'];
		if ($diff<0) print '<img src="/images/arrow_up.png"> ' . -$diff;
		elseif ($diff>0) print '<img src="/images/arrow_down.png"> ' . $diff;
		else print '<img src="/images/arrow_right.png"> =';
	    } else {
	        print 'New';
            }
	    print '</small>';
	}
	print '</td>';
    }
    print '<td>' . str_replace(' ','&nbsp;', htmlentities($row['name']));
    print '<br><small>';
    print $row['party'];
    print "</small></td>";
    print "<td>$row[area]</td>";
    print "<td align='right'>$row[sent]</td>";
    if ($row['notes']) {
        print '<td colspan="2">' . $row['notes'] . '</td>';
    } else {
        print "<td align='right'>$row[response]%</td>";
        print "<td>" . $row['low'] . "%&ndash;" . $row['high'] . "%</td>";
    }
    print "</tr>\n";
}
print '</table>';

template_draw('footer', $values);
?>
