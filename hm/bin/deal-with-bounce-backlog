#!/usr/bin/perl -w
#
# deal-with-bounce-backlog:
# Handle a backlog of bounced messages in a mailbox file.
#
#
# Copyright (c) 2009 UK Citizens Online Democracy. All rights reserved.
# Email: louise@mysociety.org; WWW: http://www.mysociety.org/

my $rcsid = ''; $rcsid .= '$Id: deal-with-bounce-backlog,v 1.3 2009-04-30 16:45:55 louise Exp $';

use strict;
require 5.8.0;

# Horrible boilerplate to set up appropriate library paths.
use FindBin;
use lib "$FindBin::Bin/../perllib";
use lib "$FindBin::Bin/../../perllib";
use mySociety::HandleMail;
use HassleMail;
my $mailbox = shift;
my @emails = mySociety::HandleMail::process_mailbox($mailbox);

for my $ref (@emails){
    my %data = %$ref;
    HassleMail::handle_incoming(\%data);
}
print "done\n";
