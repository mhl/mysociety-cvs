#!/bin/bash
# get-global-cool:
# Update template style files from Global Cool website
#
# Copyright (c) 2006 UK Citizens Online Democracy. All rights reserved.
# Email: francis@mysociety.org. WWW: http://www.mysociety.org/
# 
# $Id: get-global-cool,v 1.4 2006-08-04 09:20:22 francis Exp $

# Quit on error (particularly from wget), so we don't overwrite files
set -e

BINPATH=`dirname $0`
cd $BINPATH
cd ../web/microsites
mkdir -p autogen
cd autogen
mkdir -p global-cool
cd global-cool

function get_xhtml_to_html {
    OUTPUT=$1
    TEMPFILE=`tempfile`
    TEMPFILE2=`tempfile`
    # This is even quiet on errors, but that is OK for updating a cache
    wget -qN --output-document - HTTP://www.global-cool.com/en/wp-content/themes/gc_en/$1 >$TEMPFILE
    cat $TEMPFILE | sed "s/\/>/>/g;" > $TEMPFILE2
    chmod a+r $TEMPFILE2
    mv $TEMPFILE2 $OUTPUT
    rm -f $TEMPFILE
}

# Get new versions of cache files if Last-Modified of remote file has changed.
get_xhtml_to_html thirdPartyHeader.html
get_xhtml_to_html thirdPartyLeftNav.html
get_xhtml_to_html thirdPartyFooter.html

