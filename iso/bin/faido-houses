#!/bin/bash
#
# faido-houses:
# Temporary example use of other scripts.
#
# Copyright (c) 2007 UK Citizens Online Democracy. All rights reserved.
# Email: francis@mysociety.org; WWW: http://www.mysociety.org/
#

set -x # print each line
set -e # exit on error

DIR=$HOME/toobig/isodata/house-london1

./landregistry-to-houseprice /home/francis/toobig/landregistry/steinberg010106-311206.txt $DIR/postcodes.sqlite > $DIR/all-house-prices
cat $DIR/all-house-prices | ./houseprice-inflate > $DIR/all-house-prices-inflated

# Last two parameters: 1000 - search radius. 10 - minimum point count
RECT="`./calc-bounding-rectangle $DIR/postcodes.sqlite SW1P4DR 40000`"
cat $DIR/all-house-prices-inflated | ./houseprice-mask $RECT 1600 1600 50000 240000 1000 10 > $DIR/houseprices-240000.pgm

convert $DIR/houseprices-240000.pgm $DIR/houseprices-240000.png
eog $DIR/houseprices-240000.png

