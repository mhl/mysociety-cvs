#!/usr/bin/python2.5
#
# Get the bounds of the UK in tile co-ordinates.
#
# Copyright (c) 2009 UK Citizens Online Democracy. All rights reserved.
# Email: matthew@mysociety.org; WWW: http://www.mysociety.org/
#

import sys
sys.path.extend(("../pylib", "../../pylib", "/home/matthew/lib/python"))
import geoconvert
import urllib

if len(sys.argv) != 2:
    print "Enter base URL as parameter, e.g. http://mapumental.channel4.com/tilecache.fcgi/1.0.0/scenic/"
    sys.exit()
url_prefix = sys.argv[1]

lat_max = 60.85 # Out Stack, Shetland Islands
lat_max = 58.67 # Dunnet Head
lat_max = 55.8 # Marshall meadows Bay, Northumberland

lat_min = 49.85 # Western Rocks, Isles of Scilly
lat_min = 49.95 # The Lizard

lon_max = 1.762833 # Lowestoft Ness, Suffolk
lon_min = -8.64 # Soay
lon_min = -7.54 # Caolos, Outer Heb.
lon_min = -5.49 # Grassholm, Pembrokeshire

for zoom in range(7,16):
    (xtileL, ytileL) = geoconvert.wgs84_to_tile(lat_max, lon_min, zoom)
    (xtileR, ytileR) = geoconvert.wgs84_to_tile(lat_min, lon_max, zoom)
    (xtileL, ytileL) = (int(xtileL), int(ytileL))
    (xtileR, ytileR) = (int(xtileR), int(ytileR))

    print 'zoom %d: range %d-%d / %d-%d' % (zoom, xtileL, xtileR, ytileL, ytileR)

    for x in range(xtileL, xtileR + 1):
        for y in range(ytileL, ytileR + 1):
            url = url_prefix + str(zoom) + "/" + str(x) + "/" + str(y) + ".png"
            print url
            urllib.urlopen(url).read()


