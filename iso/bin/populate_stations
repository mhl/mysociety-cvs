#!/bin/bash

# Populates the database with all stations. Must have made the fastindex first.

set -e
. ../../shlib/deployfns
read_conf ../conf/general
cd ../bin

STATIONLIST_FILE=/tmp/stationlist-$RANDOM

make --quiet stationlist
echo "Making station list file $STATIONLIST_FILE"
./stationlist $OPTION_ISODAEMON_FASTINDEX > $STATIONLIST_FILE
echo "Loading file $STATIONLIST_FILE into database"
./populate_stations.py $STATIONLIST_FILE

cd ../tiles
echo "Culling stations"
./cull_stations.py

