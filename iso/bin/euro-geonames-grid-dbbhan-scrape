#!/usr/bin/perl

use strict;
use warnings;
use LWP::Simple;
use XML::Simple;
use DBBahn;

my $url = 'http://ws.geonames.org/cities?north=%d&south=%d&east=%d&west=%d&maxRows=100&lang=de';

my $n = shift;
my $e = shift;
my $s = $n - 1;
my $w = $e - 1;
my $cities = get(sprintf($url, $n, $s, $e, $w));
$cities = XMLin($cities, KeyAttr => []);
$cities = $cities->{geoname};
use Data::Dumper;
foreach (@$cities) {
    my $name = $_->{name};
    my $dur = get_timings($name);
    utf8::encode($name);
    print "$_->{geonameId}\t$name\t$_->{lat}\t$_->{lng}\t$dur\n";
    sleep 1;
}
