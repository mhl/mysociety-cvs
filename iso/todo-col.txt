Contours of life TODO
=====================

Email address mapumental@ ?

Worry about marmite hardware error

Invite system
    email-form.html doesn't have other variables than target_postcode in it
    Make it not email invites while server overloaded

Are housing/scenic tiles always loading from same subdomain?

Flash things:
    When house price is zero should have special text
    Also shouldn't say "more than 24 hours" for main tooltip

    Dragging map, the contour layers lag behind
    When resizing, whole map briefly flashes white

    People don't seem able to find the slider tooltip (while pressing button doesn't show)

    Tool tip to show a route
    Version where you can't scroll/zoom
    Permalinks - put the current map pan/zoom and slider values in # URL

Thank the original people who told us about existence of NPTDR


Later
-----

UI for choose different times of day and depart after

Find journeys leaving after
* check _interchange_time_after_journey
* break in _adjacent_location_times_add_stops won't work for midnight
* put some kind of route preview back and test that

Mask off sea

Render with better algorithms
- house prices (make tiles smaller in kilobytes!)
    * use median rather than mean
    * inflate house prices up to current month
    * do something clever varying circle radius according to population density?
- scenic

Route finding in proper interface

Check data quality more

Change haproxy error page to be custom

Consider getting squid to cache cached tiles?


Timetable planner questions
----------------------------

Find out why Ardvasar doesn't have any buses arriving at it

Cope with some places having silly long coordinates:
ATCO_NATIONAL_BUS.CIF:QBN13001528    4166200055150600ANNFIELD PLAIN          Annfield Plain          
ATCO_NATIONAL_BUS.CIF:QBN13001517    4166200054746400LANCHESTER              Lanchester  

Worry about the places we've stripped because they don't have a location
field in ATCO-CIF. Should we be loading their coordinates from NaPTAN?
Francis has file nptdr-missing-grid-2008.txt of the places

Put interchange times and walking speeds in as parameters
- Prevent chained walks, instead increase walk times?
- separate walk time for middle and end


Optimisation ideas
------------------

Try optimisations
    - try Flash renderer
    - refresh rate with AJAX? (and/or with LISTEN/NOTIFY in PostgreSQL if psycopg2 supports it)
    - do obvious planner improvements
    - tileserver precache station coordinates 
    - tileserver rewrite in C

Use binary search to find latest time in a journey before a time
Sort the journeys at a location by time and binary slice them 

Instead of returning all the direct connections, instead keep the connecting
journeys in a sorted list, and find just the nearest one with a binary
search. Then let the relaxed_heap do the work, rather than inserting
into the adjacents structure.


Thomas CIF file
---------------
Check that all the ids and train operation numbers and stuff in journey parts are ok - I think that they are MPS
Add direct services to Tidmouth
Add some services run by Daisy on Thomas's line
Reduced Sunday service


Larger ideas
============

Something to embed a map on your own site

Make modest maps cope better with bad network connections

Do all rendering of circles in flash, and stream the data to it.

Make sure is automatically updated with mid-year new batches of data

Currently we have:
    "how long does it take to get from everywhere, to arrive by 9am at target"
Could have:
    "how long does it take to get to everywhere, leaving target at 5pm"
And then fancier (or at least, fancier seeming, not mathematically so)
    "how long does it take to get from target, to arrive anywhere by 9am"
    "how long does it take to get to target, leaving anywhere at 5pm"

Flakiness metric 
- e.g. some measure of mean and variance of waiting time to go home between
  5pm/6pm, giving you a measure of chance of you getting home
  if you leave work at a random time in that interval. 
- Plot distribution of getting home time for leaving in a range?

Journeys changing at school holiday can really matter - get
data for this (not in NPTDR) and offer flakiness across time metric.

Handle journeys after midnight - currently it just cuts them short at midnight.
   Instead probably needs to make two copies of them one for each day. Indeed,
   to do all this really well, need to make a copy of every journey for yesterday.


